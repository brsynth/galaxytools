<tool id="icfree_converter" name="iCFree converter module" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="21.09">
    <description>Convert concentration values into volume values.</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <stdio>
        <regex match="WARNING" level="warning" />
        <regex match="ERROR" level="fatal" />
    </stdio>
    <command detect_errors="exit_code"><![CDATA[
        python -m icfree.converter
            '$cfps_parameters_file'
            '$concentrations_file'
            --sample_volume '$adv.sample_volume'
    ]]></command>
    <inputs>
        <param name="cfps_parameters_file" type="data" format="tabular" label="Cell-Free System Pameters" />
        <param name="concentrations_file" type="data" format="tabular" label="Cell-Free System Pameters Concentrations" />
    </inputs>
        <section name="adv" title="Advanced Options" expanded="false">
            <param argument="sample_volume" type="integer" value="1000" label="Final sample volume in each well in nL" />
        </section>
    <outputs>
        <data name="volumes_file" format="csv" label="Cell-Free System Pameters Volumes" />
    </outputs>
    <tests>
        <tests>
            <!-- test 1: check if identical outputs are produced with default parameters  -->
        </tests>
    </tests>
    <help><![CDATA[
Converter
==========
This converter module converts concentration values into volume values, these will be used as input for the plates_generator module. 

Input
-----
* **CFPS Parameters File**\ : The first column is the parameter (or factor) names.
The second column is the maxValue of the parameter that will be used in the sampling.
The third column is the concnetration of the stock.
The fourth column is the deadVolume of the parameter. This is used to calculate the volume of the parameter that will not be pipetted by the robot (because of viscosity).
The fifth column is the specific ratios we want to have for this parameter. If nothing defined, then take ratios given in program options. If one single number is given, then take this number as a const value.
* **CFPS Parameters Concentrations File**\ : Concentration values for each cell-free parameter.

Advanced options:
* **Sample Volume**\ : Final sample volume in each well in nL (default: 1000)

Output
------
* **volumes.csv**\ : CSV file with the volume values for each parameter.

Project Links
-------------
* `GitHub <https://github.com/brsynth/icfree-ml/tree/main/icfree/converter>`_

License
-------
* `MIT <https://github.com/brsynth/icfree-ml/blob/main/LICENSE>`_

    ]]></help>
    <creator>
        <person givenName="Yorgo" familyName="El Moubayed" email="yorgo.el-moubayed@inrae.fr" />
    </creator>
    <citations>
    </citations>
</tool>